<!DOCTYPE html>
<html lang="ko">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>비동기 - promise</title>
</head>

<body>


	<script>
		/* 
	promise 객체
		- 비동기 작업을 할수있게 하는 객체
		- 성공했을 때 호출하는 resolve함수, 실패했을때 실행하는 reject 함수가 필요
		- then(콜백함수) : 성공했을 때 호출하는 콜백함수 resolve를 넘겨줌
		- catch(콜백함수) : 실패했을 때 호출하는 콜백함수 reject를 넘겨줌
		- finally(콜백함수) : 성공,실패 여부 상관없이 마지막에 호출되는 콜백함수를 넘겨줌

		*/


		//콜백함수 이용 안하는방법
		function increase(n) {
			return new Promise((resolve, reject) => {			//resolve는 해결됐을때 reject는 문제가 생겨 종료했을때
				setTimeout(() => {
					document.write(`${n + 1}<br>`);
					if (resolve) {
						resolve(n + 1);
					}
				}, 100);
			});
		}

		increase(0)
			.then((n)=>increase(n))			//resolve에서 넘겨주는 함수가 then이 되는
			.then((n)=>increase(n))			
			.then((n)=>increase(n))			
			.then((n)=>increase(n))			
			.then((n)=>{
				return increase(n);			//이랑 같은 내용
			})			
			.then((n)=>document.write("종료<br>"));		//콜백보다 함수모양이 훨씬 간단	
			document.write("마지막 작업<br>");	//역시 마지막작업이 먼저 출력되고 숫자 출력


	</script>

</body>

</html>